(function () {
  const i18n = {
    ar: {
      nav_home:"ุงูุฑุฆูุณูุฉ", nav_about:"ูุจุฐุฉ ุนูู", nav_articles:"ุงูููุงูุงุช", nav_links:"ุฑูุงุจุท", nav_contact:"ุชูุงุตู",
      role:"ุทุงูุจ ุทุจ โข ุตุงูุน ูุญุชูู ุทุจู",
      home_kicker:"Neo-Medical Profile โข ููุซูู โข ูุชุญุฑู",
      hero_title:"ุฃุฌูู ุจุฑููุงูู ุทุจูโฆ ุจูููุฉ ุญุฏูุซุฉ ูุญุถูุฑ ููู.",
      hero_p1:"ููุง ุฑุงุญ ุชุดูู ูุณุฎุฉ ูุฑุชุจุฉ ูู ุดุบูู: ูุญุชูู ุทุจู ูุตูุฑ (Reels/Shorts) + ููุงูุงุช ุทูููุฉ ูุฑุชุจุฉ + ุฑูุงุจุท ุฑุณููุฉ.",
      hero_p2:"ุฃูุง <strong>ุนุจุฏุงูุฑุญูู ุนููู</strong> โ ุทุงูุจ ุทุจ ูุตุงูุน ูุญุชูู ุทุจู. ุฃูุฏูู ูุญุชูู ูุฑูุฒ ุนูู ุงููุถูุญุ ุชุตุญูุญ ุงูุฎุฑุงูุงุชุ ูุฑุจุท ุงููุนูููุฉ ุจุงููุงูุน.",
      hero_p3:"ูุฐุง ุงููููุน ูู ูุฌุฑุฏ โLinktreeโ โ ูู ุฃุฑุดูู ุฑุณูู ูุนุทู ุงูุทุจุงุน ุทุจู ููู ููุตุฏุงููุฉ ุฃุนูู.",
      chips1:"ุชุนููู ุทุจู", chips2:"ูุญุชูู ุจุตุฑู", chips3:"ูุชุงุจุฉ ุนูููุฉ", chips4:"ุชูุนูุฉ ุตุญูุฉ", chips5:"Myth-busting", chips6:"ูููุฌูุฉ ูุงุถุญุฉ",
      cta1:"ุงูููุงูุงุช", cta1s:"Medium", cta2:"ุฑูุงุจุทู", cta2s:"Social", cta3:"ุชูุงุตู", cta3s:"Email",
      c_disclaimer:"ุชูุจูู: ุงููุญุชูู ุชุนูููู ููุท ูููุณ ุงุณุชุดุงุฑุฉ ุทุจูุฉ.",

      s1t:"ุดูู ุฑุงุญ ุชุญุตู ููุงุ", s1d:"ููุงูุงุช ูุฑุชุจุฉ + ุฑูุงุจุท + ุฃุฑุดูู ูุญุชูู + ุตูุญุฉ ุชูุงุตู.",
      s2t:"ุฃุณููุจู ุจุงููุญุชูู", s2d:"ูุฎุชุตุฑุ ูุงุถุญุ ุนูููโฆ ูุจููุณ ุงูููุช ูุณุคูู ุจุฏูู ุชูููู.",
      s3t:"ููุด ูุฐุง ูููุ", s3d:"ุญุชู ุฃู ุดุฎุต ูุดููู ูุญุณ ุจุซูุฉ ูุงุญุชุฑุงููุฉ ูู ุฃูู ุซุงููุฉ.",

      callout:"ุฅุฐุง ุชุญุจุ ุฃูุฏุฑ ุฃุฎูู ูุณู โFeatured Videosโ ูุงุญููุง ูุฃุฑุชูุจู ูุซู ุจูุฑุชููููู ุญูููู.",

      about_title:"ูุจุฐุฉ ุนูู",
      about_p:"ุฃูุง ุทุงูุจ ุทุจ ูุตุงูุน ูุญุชูู ุทุจู. ูุฏูู ุชุจุณูุท ุงููุนูููุฉ ุงูุทุจูุฉ ูููุงุณ ุจุทุฑููุฉ ูุงุถุญุฉ ููุญุชุฑูุฉ ูููุตุงุฏุฑุ ูุจุฃุณููุจ ุญุฏูุซ ููุงุณุจ ุงูุณูุดูุงู ููุฏูุง.",
      about_p2:"ุฃุดุชุบู ุนูู ุชุญููู ุงูููุงุถูุน ุงูุซูููุฉ ุฅูู ููุงุท ุณููุฉ + ุฃูุซูุฉ + ุฑุณููุงุช/ุชูุถูุญ. ูุฃุจูู ูููุฉ ุซุงุจุชุฉ ุนุจุฑ ุฅูุณุชุบุฑุงู/ุชูู ุชูู/ููุชููุจ.",
      about_p3:"ุฅุฐุง ุฏุงุฎู ุงููููุน ูุฃูู ูุฑุฉ: ุงุจุฏุฃ ูู ุงูููุงูุงุชุ ูุจุนุฏูุง ุฑูุญ ููุฑูุงุจุท ุญุชู ุชุชุงุจุนูู ุนูู ุงูููุตุงุช.",

      articles_title:"ุงูููุงูุงุช",
      articles_p:"ููุง ุฃุฑุชูุจ ููุงูุงุชู ุงูุทูููุฉ. ูู ููุงู ูุฑุชุจุท ุจุงููุตุงุฏุฑ ูุงูููุฑุฉ ุชููู ูููููุฉ ุญุชู ูุบูุฑ ุงูุฃุทุจุงุก.",
      article1:"ููุงุฐุง ุงูุฃุทุจุงุก โูุฎุงูููโ ูู ุงูุชูุงุญ ๐",
      article1d:"ุงูุฑุฃ ุงูููุงู ุนูู Medium",

      links_title:"ุฑูุงุจุทู ุงูุฑุณููุฉ",
      links_p:"ูุฐู ุงูุตูุญุฉ ุตููุชูุง ุญุชู ุชููู ุฑุงุจุท ูุงุญุฏ ุฑุณูู ุจูู ููุงู.",
      contact_title:"ุชูุงุตู",
      contact_p:"ููุชุนุงููุงุช ูุงููุดุงุฑูุน ุงูุชุนููููุฉ ูุงููุนุงููุงุช:",
      contact_note:"ููุงุญุธุฉ: ูุง ุฃูุฏูู ุชุดุฎูุต ุดุฎุตู ุนุจุฑ ุงูุฑุณุงุฆู. ุงูุฃุณุฆูุฉ ุงูุชุนููููุฉ ูุฑุญูุจ ุจูุง.",

      langHint:"ุงููุบุฉ",
      langBtn:"EN"
    },

    en: {
      nav_home:"Home", nav_about:"About", nav_articles:"Articles", nav_links:"Links", nav_contact:"Contact",
      role:"Medical Student โข Medical Content Creator",
      home_kicker:"Neo-Medical Profile โข trust โข motion",
      hero_title:"A premium medical profile with modern identity and strong presence.",
      hero_p1:"This is my official archive: short medical content (Reels/Shorts), long-form articles, and verified links.",
      hero_p2:"Iโm <strong>Abd-Alrahman Aqeel Taha</strong> โ a medical student & medical content creator. I focus on clarity, myth-busting, and practical understanding.",
      hero_p3:"This isnโt a basic link page โ itโs a professional medical profile that builds trust instantly.",
      chips1:"Medical education", chips2:"Visual content", chips3:"Scientific writing", chips4:"Public awareness", chips5:"Myth-busting", chips6:"Clear structure",
      cta1:"Articles", cta1s:"Medium", cta2:"My links", cta2s:"Social", cta3:"Contact", cta3s:"Email",
      c_disclaimer:"Educational content only โ not medical advice.",

      s1t:"What youโll find here", s1d:"Articles + links + organized archive + contact page.",
      s2t:"My content style", s2d:"Clear, practical, and responsible โ without hype.",
      s3t:"Why it matters", s3d:"So anyone visiting feels credibility from the first second.",

      callout:"If you want, I can add a โFeatured Videosโ portfolio section later.",

      about_title:"About",
      about_p:"Iโm a medical student and medical content creator. My goal is to simplify medical knowledge in a modern, responsible, and audience-friendly way.",
      about_p2:"I turn heavy topics into clean points, examples, and visuals โ and keep a consistent identity across platforms.",
      about_p3:"New here? Start with Articles, then use Links to follow my platforms.",

      articles_title:"Articles",
      articles_p:"This page lists my long-form writing with structured ideas and references.",
      article1:"Why Doctors Are Afraid of Apples ๐",
      article1d:"Read on Medium",

      links_title:"Official Links",
      links_p:"This is my single official bio link page.",
      contact_title:"Contact",
      contact_p:"For collaborations, educational projects, and invitations:",
      contact_note:"Note: I canโt provide personal diagnosis via messages. Educational questions are welcome.",

      langHint:"Language",
      langBtn:"AR"
    }
  };

  const defaultLang = "ar";
  const saved = localStorage.getItem("lang");
  const lang = saved || defaultLang;

  const $ = (q) => document.querySelector(q);
  const $$ = (q) => document.querySelectorAll(q);

  function setDirAndLang(l){
    const isAr = l === "ar";
    document.documentElement.lang = l;
    document.documentElement.dir = isAr ? "rtl" : "ltr";
  }

  function applyI18n(l){
    const dict = i18n[l] || i18n[defaultLang];
    $$("[data-i18n]").forEach(el=>{
      const key = el.getAttribute("data-i18n");
      if (dict[key]) el.textContent = dict[key];
    });
    $$("[data-i18n-html]").forEach(el=>{
      const key = el.getAttribute("data-i18n-html");
      if (dict[key]) el.innerHTML = dict[key];
    });

    const btn = $("#langToggle");
    if(btn) btn.textContent = dict.langBtn;

    const hint = $("#langHint");
    if(hint) hint.textContent = dict.langHint;
  }

  function markActiveNav(){
    const path = location.pathname.split("/").pop() || "index.html";
    $$(".nav a").forEach(a=>{
      if(a.getAttribute("href") === path) a.classList.add("active");
    });
  }

  function fadeIn(){
    const page = $(".page");
    if(!page) return;
    requestAnimationFrame(()=> page.classList.add("ready"));
  }

  function revealOnScroll(){
    const els = $$(".reveal");
    if(!els.length) return;
    const io = new IntersectionObserver((entries)=>{
      entries.forEach(e=>{
        if(e.isIntersecting) e.target.classList.add("in");
      });
    }, {threshold: 0.14});
    els.forEach(el=> io.observe(el));
  }

  function parallaxMedia(){
    const media = $(".media");
    if(!media) return;
    if(!window.matchMedia("(hover:hover)").matches) return;

    let raf = null;
    const onMove = (ev)=>{
      const r = media.getBoundingClientRect();
      const x = (ev.clientX - (r.left + r.width/2)) / r.width;
      const y = (ev.clientY - (r.top + r.height/2)) / r.height;
      if(raf) cancelAnimationFrame(raf);
      raf = requestAnimationFrame(()=>{
        media.style.transform = `rotateX(${(-y*2)}deg) rotateY(${(x*2)}deg)`;
      });
    };
    const reset = ()=> media.style.transform = "rotateX(0deg) rotateY(0deg)";
    media.addEventListener("pointermove", onMove);
    media.addEventListener("pointerleave", reset);
  }

  function spawnFloaters(){
    const layer = $(".floaters");
    if(!layer) return;

    const icons = ["i1","i2","i3"];
    const count = 14;

    for(let i=0;i<count;i++){
      const el = document.createElement("div");
      el.className = `floater ${icons[i % icons.length]}`;
      const left = Math.random()*100;
      const delay = Math.random()*10;
      const dur = 10 + Math.random()*10;
      const size = 34 + Math.random()*34;
      el.style.left = left + "vw";
      el.style.animationDelay = delay + "s";
      el.style.animationDuration = dur + "s";
      el.style.width = size + "px";
      el.style.height = size + "px";
      el.style.top = (70 + Math.random()*40) + "vh";
      layer.appendChild(el);
    }
  }

  function init(){
    setDirAndLang(lang);
    applyI18n(lang);
    markActiveNav();
    fadeIn();
    revealOnScroll();
    parallaxMedia();
    spawnFloaters();

    const btn = $("#langToggle");
    if(btn){
      btn.addEventListener("click", ()=>{
        const current = localStorage.getItem("lang") || lang;
        const next = current === "ar" ? "en" : "ar";
        localStorage.setItem("lang", next);
        setDirAndLang(next);
        applyI18n(next);
      });
    }

    const y = $("#year");
    if(y) y.textContent = new Date().getFullYear();
  }

  document.addEventListener("DOMContentLoaded", init);
})();
